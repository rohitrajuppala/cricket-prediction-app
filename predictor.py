
import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from sklearn.pipeline import Pipeline
from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import OneHotEncoder

# In-memory dataset filtered for Team1 as India only
data = [{'venue': 'Green Park', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Vidarbha Cricket Association Stadium, Jamtha', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'M Chinnaswamy Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Central Broward Regional Park Stadium Turf Ground', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'West Indies'}, {'venue': 'Asian Institute of Technology Ground', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Barsapara Cricket Stadium', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'Australia'}, {'venue': 'Sophia Gardens', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Arun Jaitley Stadium', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'New Zealand', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Greenfield International Stadium', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'New Zealand', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'The Wanderers Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'SuperSport Park', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'Newlands', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Barabati Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Holkar Cricket Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'The Wanderers Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'Newlands', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Brabourne Stadium', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'Australia'}, {'venue': 'Brabourne Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'R.Premadasa Stadium, Khettarama', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'Sri Lanka'}, {'venue': 'R.Premadasa Stadium, Khettarama', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'The Village, Malahide', 'team1': 'India', 'team2': 'Ireland', 'toss_winner': 'Ireland', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'The Village, Malahide', 'team1': 'India', 'team2': 'Ireland', 'toss_winner': 'Ireland', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Kinrara Academy Oval', 'team1': 'India', 'team2': 'Malaysia', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Royal Selangor Club', 'team1': 'India', 'team2': 'Thailand', 'toss_winner': 'Thailand', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Kinrara Academy Oval', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'Bangladesh'}, {'venue': 'Kinrara Academy Oval', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'Bangladesh'}, {'venue': 'Providence Stadium', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Providence Stadium', 'team1': 'India', 'team2': 'Ireland', 'toss_winner': 'Ireland', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Providence Stadium', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Sir Vivian Richards Stadium, North Sound', 'team1': 'India', 'team2': 'England', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'England'}, {'venue': 'Chilaw Marians Cricket Club Ground', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Bharat Ratna Shri Atal Bihari Vajpayee Ekana Cricket Stadium', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Dr. Y.S. Rajasekhara Reddy ACA-VDCA Cricket Stadium', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'Australia'}, {'venue': 'M.Chinnaswamy Stadium', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'Australia'}, {'venue': 'Barsapara Cricket Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Barsapara Cricket Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Barsapara Cricket Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'bat', 'winner': 'England'}, {'venue': 'Junction Oval', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'New Zealand', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Junction Oval', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Punjab Cricket Association IS Bindra Stadium, Mohali', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'M.Chinnaswamy Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'South Africa'}, {'venue': 'Arun Jaitley Stadium', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'Bangladesh'}, {'venue': 'Saurashtra Cricket Association Stadium', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Vidarbha Cricket Association Stadium, Jamtha', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Rajiv Gandhi International Stadium, Uppal', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Greenfield International Stadium', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'West Indies'}, {'venue': 'Wankhede Stadium', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Central Broward Regional Park Stadium Turf Ground', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Central Broward Regional Park Stadium Turf Ground', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Lalabhai Contractor Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Lalabhai Contractor Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Lalabhai Contractor Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'bat', 'winner': 'South Africa'}, {'venue': 'Holkar Cricket Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Maharashtra Cricket Association Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Lalabhai Contractor Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Manuka Oval', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Narendra Modi Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Narendra Modi Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Narendra Modi Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Narendra Modi Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Bharat Ratna Shri Atal Bihari Vajpayee Ekana Cricket Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'Bharat Ratna Shri Atal Bihari Vajpayee Ekana Cricket Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'County Ground, Hove', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'County Ground, Chelmsford', 'team1': 'India', 'team2': 'England', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'England'}, {'venue': 'R Premadasa Stadium, Colombo', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'R Premadasa Stadium, Colombo', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'Sri Lanka'}, {'venue': 'R Premadasa Stadium, Colombo', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'Sri Lanka'}, {'venue': 'Carrara Oval', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'Australia'}, {'venue': 'Dubai International Cricket Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'field', 'winner': 'Pakistan'}, {'venue': 'Dubai International Cricket Stadium', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'New Zealand', 'toss_decision': 'field', 'winner': 'New Zealand'}, {'venue': 'Zayed Cricket Stadium, Abu Dhabi', 'team1': 'India', 'team2': 'Afghanistan', 'toss_winner': 'Afghanistan', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'The Rose Bowl, Southampton', 'team1': 'India', 'team2': 'England', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Edgbaston, Birmingham', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Eden Gardens, Kolkata', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Eden Gardens, Kolkata', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Eden Gardens, Kolkata', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Bharat Ratna Shri Atal Bihari Vajpayee Ekana Cricket Stadium, Lucknow', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Arun Jaitley Stadium, Delhi', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'Barabati Stadium, Cuttack', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'Dr. Y.S. Rajasekhara Reddy ACA-VDCA Cricket Stadium, Visakhapatnam', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Saurashtra Cricket Association Stadium, Rajkot', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Edgbaston, Birmingham', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'Australia'}, {'venue': 'Edgbaston, Birmingham', 'team1': 'India', 'team2': 'Barbados', 'toss_winner': 'Barbados', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Edgbaston, Birmingham', 'team1': 'India', 'team2': 'England', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Sydney Cricket Ground', 'team1': 'India', 'team2': 'Netherlands', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Perth Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'South Africa'}, {'venue': 'Adelaide Oval', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Melbourne Cricket Ground', 'team1': 'India', 'team2': 'Zimbabwe', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Adelaide Oval', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Riverside Ground, Chester-le-Street', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'County Ground, Bristol', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'The Village, Malahide, Dublin', 'team1': 'India', 'team2': 'Ireland', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Brian Lara Stadium, Tarouba, Trinidad', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Warner Park, Basseterre, St Kitts', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'West Indies'}, {'venue': 'Central Broward Regional Park Stadium Turf Ground, Lauderhill', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Central Broward Regional Park Stadium Turf Ground, Lauderhill', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Rangiri Dambulla International Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Rangiri Dambulla International Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'Sri Lanka'}, {'venue': 'Bay Oval, Mount Maunganui', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'New Zealand', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Dubai International Cricket Stadium', 'team1': 'India', 'team2': 'Hong Kong', 'toss_winner': 'Hong Kong', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Dubai International Cricket Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'field', 'winner': 'Pakistan'}, {'venue': 'Dubai International Cricket Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'Sri Lanka'}, {'venue': 'Dubai International Cricket Stadium', 'team1': 'India', 'team2': 'Afghanistan', 'toss_winner': 'Afghanistan', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Punjab Cricket Association IS Bindra Stadium, Mohali, Chandigarh', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'Australia'}, {'venue': 'Barsapara Cricket Stadium, Guwahati', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Sylhet International Cricket Stadium, Academy Ground', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Sylhet International Cricket Stadium, Academy Ground', 'team1': 'India', 'team2': 'Malaysia', 'toss_winner': 'Malaysia', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Sylhet International Cricket Stadium, Academy Ground', 'team1': 'India', 'team2': 'United Arab Emirates', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Sylhet International Cricket Stadium', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Sylhet International Cricket Stadium', 'team1': 'India', 'team2': 'Thailand', 'toss_winner': 'Thailand', 'toss_decision': 'field', 'winner': 'India'}, {'venue': "St George's Park, Gqeberha", 'team1': 'India', 'team2': 'Ireland', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Buffalo Park, East London', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Buffalo Park, East London', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Buffalo Park, East London', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'South Africa'}, {'venue': 'Dr DY Patil Sports Academy, Mumbai', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'field', 'winner': 'Australia'}, {'venue': 'Wankhede Stadium, Mumbai', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Saurashtra Cricket Association Stadium, Rajkot', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Narendra Modi Stadium, Ahmedabad', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Providence Stadium, Guyana', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'West Indies'}, {'venue': 'Central Broward Regional Park Stadium Turf Ground, Lauderhill', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'West Indies'}, {'venue': 'Shere Bangla National Stadium, Mirpur', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium, Mirpur', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'Bangladesh'}, {'venue': 'Malahide, Dublin', 'team1': 'India', 'team2': 'Ireland', 'toss_winner': 'Ireland', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Zhejiang University of Technology Cricket Field', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Zhejiang University of Technology Cricket Field', 'team1': 'India', 'team2': 'Nepal', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'New Wanderers Stadium', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'New Zealand'}, {'venue': 'New Wanderers Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Brabourne Stadium', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Trent Bridge', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'New Zealand', 'toss_decision': 'bat', 'winner': 'New Zealand'}, {'venue': 'Trent Bridge', 'team1': 'India', 'team2': 'Ireland', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': "Lord's", 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'West Indies'}, {'venue': 'Trent Bridge', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'bat', 'winner': 'South Africa'}, {'venue': 'Beausejour Stadium, Gros Islet', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Beausejour Stadium, Gros Islet', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'Sri Lanka'}, {'venue': 'Vidarbha Cricket Association Stadium, Jamtha', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'Sri Lanka'}, {'venue': 'Punjab Cricket Association Stadium, Mohali', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Eden Gardens', 'team1': 'India', 'team2': 'England', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'England'}, {'venue': 'R Premadasa Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'R Premadasa Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Galle International Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'bat', 'winner': 'Pakistan'}, {'venue': 'Subrata Roy Sahara Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Wankhede Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'MA Chidambaram Stadium, Chepauk', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'New Zealand'}, {'venue': 'Guanggong International Cricket Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Guanggong International Cricket Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'M Chinnaswamy Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'field', 'winner': 'Pakistan'}, {'venue': 'Sardar Patel Stadium, Motera', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Saurashtra Cricket Association Stadium', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'Sri Lanka'}, {'venue': 'Sylhet Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'bat', 'winner': 'Sri Lanka'}, {'venue': 'Sylhet Stadium', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Sylhet Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'India', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Himachal Pradesh Cricket Association Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'Barabati Stadium', 'team1': 'India', 'team2': 'South Africa', 'toss_winner': 'South Africa', 'toss_decision': 'field', 'winner': 'South Africa'}, {'venue': 'Vidarbha Cricket Association Stadium, Jamtha', 'team1': 'India', 'team2': 'New Zealand', 'toss_winner': 'New Zealand', 'toss_decision': 'bat', 'winner': 'New Zealand'}, {'venue': 'Eden Gardens', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'M Chinnaswamy Stadium', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Punjab Cricket Association IS Bindra Stadium, Mohali', 'team1': 'India', 'team2': 'Australia', 'toss_winner': 'Australia', 'toss_decision': 'bat', 'winner': 'India'}, {'venue': 'Wankhede Stadium', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'West Indies', 'toss_decision': 'field', 'winner': 'West Indies'}, {'venue': 'M Chinnaswamy Stadium', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Feroz Shah Kotla', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'Pakistan', 'toss_decision': 'field', 'winner': 'Pakistan'}, {'venue': 'Himachal Pradesh Cricket Association Stadium', 'team1': 'India', 'team2': 'England', 'toss_winner': 'England', 'toss_decision': 'field', 'winner': 'England'}, {'venue': 'Punjab Cricket Association IS Bindra Stadium, Mohali', 'team1': 'India', 'team2': 'West Indies', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'West Indies'}, {'venue': 'Maharashtra Cricket Association Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'Sri Lanka'}, {'venue': 'JSCA International Stadium Complex', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'Sri Lanka', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Dr. Y.S. Rajasekhara Reddy ACA-VDCA Cricket Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'Bangladesh', 'toss_winner': 'Bangladesh', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'Pakistan', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'Sri Lanka', 'toss_winner': 'India', 'toss_decision': 'field', 'winner': 'India'}, {'venue': 'Shere Bangla National Stadium', 'team1': 'India', 'team2': 'United Arab Emirates', 'toss_winner': 'United Arab Emirates', 'toss_decision': 'bat', 'winner': 'India'}]

df = pd.DataFrame(data)
X = df.drop(columns=["winner"])
y = df["winner"]

categorical_cols = X.columns.tolist()

preprocessor = ColumnTransformer(
    transformers=[("cat", OneHotEncoder(handle_unknown="ignore"), categorical_cols)]
)

model = Pipeline(steps=[
    ("preprocessor", preprocessor),
    ("classifier", RandomForestClassifier(n_estimators=25, max_depth=10, random_state=42))
])

model.fit(X, y)

def predict_match_winner(venue, opponent, toss_winner, toss_decision):
    input_df = pd.DataFrame([{
        "venue": venue,
        "team1": "India",
        "team2": opponent,
        "toss_winner": toss_winner,
        "toss_decision": toss_decision
    }])
    return model.predict(input_df)[0]
